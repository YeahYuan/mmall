webpackJsonp([2],{0:function(e,t,s){e.exports=s(66)},5:function(e,t,s){mm=s(1);var i={getInventory:function(e,t){mm.request({url:mm.getServerUrl("/order/get_order_cart_product.do"),method:"POST",success:e,error:t})},createOrder:function(e,t,s){mm.request({url:mm.getServerUrl("/order/create.do"),data:e,success:t,error:s})},getProductList:function(e,t,s){mm.request({url:mm.getServerUrl("/order/list.do"),data:e,success:t,error:s})},getOrderDetail:function(e,t,s){mm.request({url:mm.getServerUrl("/order/detail.do"),data:{orderNo:e},success:t,error:s})},orderCancal:function(e,t,s){mm.request({url:mm.getServerUrl("/order/cancel.do"),data:{orderNo:e},success:t,error:s})}};e.exports=i},13:function(e,t,s){mm=s(1);var i={getAddressList:function(e,t){mm.request({url:mm.getServerUrl("/shipping/list.do"),data:{pageSize:50},method:"POST",success:e,error:t})},getAddress:function(e,t,s){mm.request({url:mm.getServerUrl("/shipping/select.do"),data:e,method:"POST",success:t,error:s})},addAddress:function(e,t,s){mm.request({url:mm.getServerUrl("/shipping/add.do"),data:e,method:"POST",success:t,error:s})},updateAddress:function(e,t,s){mm.request({url:mm.getServerUrl("/shipping/update.do"),data:e,method:"POST",success:t,error:s})},deleteAddress:function(e,t,s){mm.request({url:mm.getServerUrl("/shipping/del.do"),data:e,method:"POST",success:t,error:s})}};e.exports=i},25:function(e,t){},45:function(e,t){e.exports='<div class=modalContainer> <div class=receiverHead> {{^isUpdate}} <p>新建地址</p> {{/isUpdate}} {{#isUpdate}} <p>编辑地址</p> {{/isUpdate}} <span class="close fa fa-close"></span> </div> <div class=receiverBody> <div class=form> <div class=receiver-item> <label><span class=required>*</span> 收件人姓名:</label> <input type=text placeholder=请输入收件人姓名 id=receiver-name value={{data.receiverName}}> </div> <div class=receiver-item> <div class=addressSelect> <label><span class=required>*</span>所在城市:</label> <select id=receiver-select-province> </select> <select id=receiver-select-city> <option value=请选择>请选择</option> </select> </div> </div> <div class=receiver-item> <label><span class=required>*</span>收件人地址:</label> <input type=text placeholder=请输入收件人地址 id=receiver-address value={{data.receiverAddress}}> </div> <div class=receiver-item> <label><span class=required>*</span>收件人号码:</label> <input type=text placeholder=请输入收件人号码 id=receiver-phone value={{data.receiverPhone}}> </div> <div class=receiver-item> <label>邮政编码:</label> <input type=text placeholder=如：100000 id=receiver-zip value={{data.receiverZip}}> </div> <div class="btn receiver-address-submit"> 保存收货地址 </div> <input type=hidden id=modal-id data-id={{data.id}}> </div> </div> </div>'},46:function(e,t){e.exports='{{#list}} <div class=address-item data-id={{id}}> <div class=address-title> <span class=ad-province>{{receiverProvince}}</span> <span class=ad-city>{{receiverCity}}</span> <span class=ad-name>({{receiverName}})收</span> </div> <div class=address-detail> <span class=ad-detail>{{receiverAddress}}</span> <span class=phone>{{receiverPhone}}</span> </div> <div class=address-operate> <span class=ad-update>编辑</span> <span class=ad-delete>删除</span> </div> </div> {{/list}} <div class=address-add> <div class=add-new> <i class="fa fa-plus"></i> <i class=add-text>添加新地址</i> </div> </div> '},47:function(e,t){e.exports='<div class=inventory-title> <span class=t-item>商品详情</span> <span class=t-item>价格</span> <span class=t-item>数量</span> <span class=t-item>小计</span> </div> {{#orderItemVoList}} <div class=inventory-item data-product-id={{productId}}> <a href=""><img src={{imageHost}}{{productImage}} alt={{productName}} class="img t-item"> </a> <span class="describe t-item"><a href="" class=link>{{productName}}</a> </span> <span class="price t-item">{{currentUnitPrice}}</span> <span class="number t-item">{{quantity}}</span> <span class="subtotal t-item">{{totalPrice}}</span> </div> {{/orderItemVoList}} <div class=panel-submit> <span class=text>订单总价: <span class=total>￥{{productTotalPrice}}</span> </span> <span class="btn submit">提交订单</span> </div>'},65:function(e,t,s){var i=s(1),r=s(13),a=s(45),d=s(78),n={data:{},show:function(e){this.option=e,this.option.data=e.data||{},this.$modal=$(".modal"),this.loadModal(e),this.bindEvent()},hide:function(){this.$modal.hide()},loadModal:function(e){var t=i.renderHtml(a,e);this.$modal.html(t).show(),this.loadProvinces()},bindEvent:function(){var e=this;$(".close").off("click").click(function(){e.$modal.hide()}),$(".receiver-address-submit").click(function(){e.option.isUpdate?e.updateAddress():(console.log("点击增加地址"),e.addAddress())}),$(document).on("change","#receiver-select-province",function(){var t=$(this).val();e.loadCitys(t)})},loadProvinces:function(){var e=this.loadSelect(d.getProvinces());$("#receiver-select-province").html(e),this.option.isUpdate&&this.option.data.receiverProvince&&($("#receiver-select-province").val(this.option.data.receiverProvince),this.loadCitys(this.option.data.receiverProvince))},loadCitys:function(e){var t=this.loadSelect(d.getCities(e));$("#receiver-select-city").html(t),this.option.isUpdate&&this.option.data.receiverCity&&$("#receiver-select-city").val(this.option.data.receiverCity)},loadSelect:function(e){for(var t="<option>请选择</option>",s=0,i=e.length;s<i;s++)t+="<option>"+e[s]+"</option>";return t},addAddress:function(){var e=this,t=e.getAddressInfo(),s=this.validateForm(t);s.isOk?(console.log("验证通过"),r.addAddress(t,function(t){console.log("添加地址"),e.option.onSuccess(),e.hide()},function(e){i.errorHint(e)})):alert(s.msg)},updateAddress:function(){var e=this,t=e.getAddressInfo(),s=this.validateForm(t);s.isOk?r.updateAddress(t,function(t){e.option.onSuccess(),e.hide()},function(e){i.errorHint(e)}):alert(s.msg)},getAddressInfo:function(){return this.data.newAddressInfo={receiverName:$("#receiver-name").val(),receiverProvince:$("#receiver-select-province").val(),receiverCity:$("#receiver-select-city").val(),receiverAddress:$("#receiver-address").val(),receiverPhone:$("#receiver-phone").val(),receiverZip:$("#receiver-zip").val()},this.option.isUpdate&&(this.data.newAddressInfo.id=$("#modal-id").data("id")),this.data.newAddressInfo},validateForm:function(e){var t={isOk:!0,msg:""};return i.validate(e.receiverName,"notEmpty")?(t.isOk=!0,i.validate(e.receiverAddress,"notEmpty")?(t.isOk=!0,"请选择"===e.receiverProvince||"请选择"===e.receiverCity?(t.isOk=!1,t.msg="请选择收货人省份和城市",t):(t.isOk=!0,i.validate(e.receiverPhone,"notEmpty")?i.validate(e.receiverPhone,"phone")?(t.isOk=!0,t):(t.isOk=!1,t.msg="请填写正确的手机号格式",t):(t.isOk=!1,t.msg="请填写收件人手机号码",t))):(t.isOk=!1,t.msg="请填写收件人地址",t)):(t.isOk=!1,t.msg="请填写收件人姓名",t)}};e.exports=n},66:function(e,t,s){s(25);var i=s(1),r=s(13),a=s(5),d=s(65),n=s(46),o=s(47),c={data:{selectAddressId:null},init:function(){this.onLoad(),this.bindEvent()},onLoad:function(){this.loadProductList(),this.loadAddressList()},bindEvent:function(){var e=this;$(document).on("click",".address-item",function(){$(this).addClass("active").siblings(".address-item").removeClass("active"),e.data.selectAddressId=$(this).data("id")}),$(document).on("click",".submit",function(){var t=e.data.selectAddressId;t?a.createOrder({shippingId:t},function(e){window.location.href="./pay.html?orderNo="+e.data.orderNo},function(e){i.errorHint("errMsg")}):i.errorHint("请选择一个地址")}),$(document).on("click",".address-add",function(){d.show({isUpdate:!1,onSuccess:function(){e.onLoad()}})}),$(document).on("click",".ad-update",function(t){var s=$(this).parents(".address-item").data("id");r.getAddress({shippingId:s},function(t){d.show({isUpdate:!0,data:t.data,onSuccess:function(){e.onLoad()}})},function(e){i.errorHint(e)}),t.stopPropagation()}),$(document).on("click",".ad-delete",function(t){var s=$(this).parents(".address-item").data("id");r.deleteAddress({shippingId:s},function(t){e.loadAddressList()},function(e){i.errorHint(e)}),t.stopPropagation()})},loadAddressList:function(){var e=this;r.getAddressList(function(t){var s=i.renderHtml(n,t.data);$(".address").html(s),e.data.selectAddressId&&$(".address-item").each(function(){var t=$(this);t.data("id")===e.data.selectAddressId&&t.addClass("active")})},function(e){$(".address").html("<p>出错了，请刷新</p>")})},loadProductList:function(){a.getInventory(function(e){var t=i.renderHtml(o,e.data);$(".inventory-con").html(t)},function(e){$(".address").html("<p>出错了，请刷新</p>")})}};$(function(){c.init()})},78:function(e,t){var s={cityInfo:{"北京":["北京"],"上海":["上海"],"天津":["天津"],"重庆":["重庆"],"河北省":["石家庄","张家口","承德","秦皇岛","唐山","廊坊","保定","沧州","衡水","邢台","邯郸"],"山西省":["太原","大同","朔州","阳泉","长治","晋城","忻州","吕梁","晋中","临汾","运城"],"辽宁省":["沈阳","朝阳","阜新","铁岭","抚顺","本溪","辽阳","鞍山","丹东","大连","营口","盘锦","锦州","葫芦岛"],"吉林省":["长春","白城","松原","吉林","四平","辽源","通化","白山","延边"],"黑龙江省":["哈尔滨","齐齐哈尔","黑河","大庆","伊春","鹤岗","佳木斯","双鸭山","七台河","鸡西","牡丹江","绥化","大兴安"],"江苏省":["南京","徐州","连云港","宿迁","淮阴","盐城","扬州","泰州","南通","镇江","常州","无锡","苏州"],"浙江省":["杭州","湖州","嘉兴","舟山","宁波","绍兴","金华","台州","温州","丽水"],"安徽省":["合肥","宿州","淮北","阜阳","蚌埠","淮南","滁州","马鞍山","芜湖","铜陵","安庆","黄山","六安","巢湖","池州","宣城"],"福建省":["福州","南平","三明","莆田","泉州","厦门","漳州","龙岩","宁德"],"江西省":["南昌","九江","景德镇","鹰潭","新余","萍乡","赣州","上饶","抚州","宜春","吉安"],"山东省":["济南","聊城","德州","东营","淄博","潍坊","烟台","威海","青岛","日照","临沂","枣庄","济宁","泰安","莱芜","滨州","菏泽"],"河南省":["郑州","三门峡","洛阳","焦作","新乡","鹤壁","安阳","濮阳","开封","商丘","许昌","漯河","平顶山","南阳","信阳","周口","驻马店"],"湖北省":["武汉","十堰","襄攀","荆门","孝感","黄冈","鄂州","黄石","咸宁","荆州","宜昌","恩施","襄樊"],"湖南省":["长沙","张家界","常德","益阳","岳阳","株洲","湘潭","衡阳","郴州","永州","邵阳","怀化","娄底","湘西"],"广东省":["广州","清远","韶关","河源","梅州","潮州","汕头","揭阳","汕尾","惠州","东莞","深圳","珠海","江门","佛山","肇庆","云浮","阳江","茂名","湛江"],"海南省":["海口","三亚"],"四川省":["成都","广元","绵阳","德阳","南充","广安","遂宁","内江","乐山","自贡","泸州","宜宾","攀枝花","巴中","达川","资阳","眉山","雅安","阿坝","甘孜","凉山"],"贵州省":["贵阳","六盘水","遵义","毕节","铜仁","安顺","黔东南","黔南","黔西南"],"云南省":["昆明","曲靖","玉溪","丽江","昭通","思茅","临沧","保山","德宏","怒江","迪庆","大理","楚雄","红河","文山","西双版纳"],"陕西省":["西安","延安","铜川","渭南","咸阳","宝鸡","汉中","榆林","商洛","安康"],"甘肃省":["兰州","嘉峪关","金昌","白银","天水","酒泉","张掖","武威","庆阳","平凉","定西","陇南","临夏","甘南"],"青海省":["西宁","海东","西宁","海北","海南","黄南","果洛","玉树","海西"],"内蒙古":["呼和浩特","包头","乌海","赤峰","呼伦贝尔盟","兴安盟","哲里木盟","锡林郭勒盟","乌兰察布盟","鄂尔多斯","巴彦淖尔盟","阿拉善盟"],"广西":["南宁","桂林","柳州","梧州","贵港","玉林","钦州","北海","防城港","南宁","百色","河池","柳州","贺州"],"西藏":["拉萨","那曲","昌都","林芝","山南","日喀则","阿里"],"宁夏":["银川","石嘴山","吴忠","固原"],"新疆":["乌鲁木齐","克拉玛依","喀什","阿克苏","和田","吐鲁番","哈密","博尔塔拉","昌吉","巴音郭楞","伊犁","塔城","阿勒泰"],"香港":["香港"],"澳门":["澳门"],"台湾":["台北","台南","其他"]},getProvinces:function(){var e=[];for(var t in this.cityInfo)e.push(t);return e},getCities:function(e){return this.cityInfo[e]||[]}};e.exports=s}});